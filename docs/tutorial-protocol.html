<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Tutorial: Protocol Specification</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-modules"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-kadence_churnfilter.html">kadence/churnfilter</a></div><div class="sidebar-section-children"><a href="module-kadence_constants.html">kadence/constants</a></div><div class="sidebar-section-children"><a href="module-kadence_contentaddress.html">kadence/contentaddress</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse.html">kadence/eclipse</a></div><div class="sidebar-section-children"><a href="module-kadence_hashcash.html">kadence/hashcash</a></div><div class="sidebar-section-children"><a href="module-kadence_hibernate.html">kadence/hibernate</a></div><div class="sidebar-section-children"><a href="module-kadence_logger.html">kadence/logger</a></div><div class="sidebar-section-children"><a href="module-kadence_onion.html">kadence/onion</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar.html">kadence/quasar</a></div><div class="sidebar-section-children"><a href="module-kadence_rolodex.html">kadence/rolodex</a></div><div class="sidebar-section-children"><a href="module-kadence_spartacus.html">kadence/spartacus</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse.html">kadence/traverse</a></div><div class="sidebar-section-children"><a href="module-kadence_trust.html">kadence/trust</a></div><div class="sidebar-section-children"><a href="module-kadence_utils.html">kadence/utils</a></div><div class="sidebar-section-children"><a href="module-kadence_version.html">kadence/version</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AbstractNode.html">AbstractNode</a></div><div class="sidebar-section-children"><a href="Bucket.html">Bucket</a></div><div class="sidebar-section-children"><a href="ContactList.html">ContactList</a></div><div class="sidebar-section-children"><a href="Control.html">Control</a></div><div class="sidebar-section-children"><a href="ErrorRules.html">ErrorRules</a></div><div class="sidebar-section-children"><a href="HTTPSTransport.html">HTTPSTransport</a></div><div class="sidebar-section-children"><a href="HTTPTransport.html">HTTPTransport</a></div><div class="sidebar-section-children"><a href="KademliaNode.html">KademliaNode</a></div><div class="sidebar-section-children"><a href="KademliaRules.html">KademliaRules</a></div><div class="sidebar-section-children"><a href="Messenger.html">Messenger</a></div><div class="sidebar-section-children"><a href="module-kadence_churnfilter-ChurnFilterPlugin.html">ChurnFilterPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_contentaddress-ContentAddressPlugin.html">ContentAddressPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipseIdentity.html">EclipseIdentity</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipsePlugin.html">EclipsePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipseRules.html">EclipseRules</a></div><div class="sidebar-section-children"><a href="module-kadence_hashcash-HashCashPlugin.html">HashCashPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_hibernate-HibernatePlugin.html">HibernatePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_logger-IncomingMessageLogger.html">IncomingMessageLogger</a></div><div class="sidebar-section-children"><a href="module-kadence_logger-OutgoingMessageLogger.html">OutgoingMessageLogger</a></div><div class="sidebar-section-children"><a href="module-kadence_onion-OnionPlugin.html">OnionPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar-QuasarPlugin.html">QuasarPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar-QuasarRules.html">QuasarRules</a></div><div class="sidebar-section-children"><a href="module-kadence_rolodex-RolodexPlugin.html">RolodexPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_spartacus-SpartacusPlugin.html">SpartacusPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-NATPMPStrategy.html">NATPMPStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-ReverseTunnelStrategy.html">ReverseTunnelStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-TraversePlugin.html">TraversePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-TraverseStrategy.html">TraverseStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-UPNPStrategy.html">UPNPStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_trust-TrustPlugin.html">TrustPlugin</a></div><div class="sidebar-section-children"><a href="RoutingTable.html">RoutingTable</a></div><div class="sidebar-section-children"><a href="UDPTransport.html">UDPTransport</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-events"><div>Events</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AbstractNode.html#event:error">error</a></div><div class="sidebar-section-children"><a href="AbstractNode.html#event:join">join</a></div><div class="sidebar-section-children"><a href="KademliaNode.html#event:error">error</a></div><div class="sidebar-section-children"><a href="KademliaNode.html#event:join">join</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-config.html">Configuration Guide</a></div><div class="sidebar-section-children"><a href="tutorial-identities.html">Contacts and Identities</a></div><div class="sidebar-section-children"><a href="tutorial-install.html">Installing Kadence</a></div><div class="sidebar-section-children"><a href="tutorial-messengers.html">Message Format</a></div><div class="sidebar-section-children"><a href="tutorial-middleware.html">Middleware Stack</a></div><div class="sidebar-section-children"><a href="tutorial-nat.html">Traversing NATs and Firewalls</a></div><div class="sidebar-section-children"><a href="tutorial-plugins.html">Using and Authoring Plugins</a></div><div class="sidebar-section-children"><a href="tutorial-protocol.html">Protocol Specification</a></div><div class="sidebar-section-children"><a href="tutorial-quickstart.html">Getting Started</a></div><div class="sidebar-section-children"><a href="tutorial-transport-adapters.html">Transport Adapters</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section><header><h2>Protocol Specification</h2></header><article><h3 id="version-3.0-(march-3%2C-2018)">Version 3.0 (March 3, 2018)</h3><p>Lily Anne Hall (lily@tacticalchihuahua.lol)</p><hr><h3 id="0-license">0 License</h3><p>Copyright (C) 2018 Lily Anne Hall</p><p>Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation; with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts. A copy of the license is included in the &quot;LICENSE&quot; file.</p><h3 id="1-introduction">1 Introduction</h3><p>This specification documents the Kadence protocol in its entirety for the purpose of enabling its implementation in other languages. Described here, is the protocol base - the minimum specification for compatibility with Kadence. Additional optional extensions to this work may be defined in a future specification.</p><h3 id="2-identities">2 Identities</h3><p>Every node (host computer speaking the Kadence protocol) on the network possesses a unique cryptographic identity. This identity is used to derive a special 160 bit identifier for the purpose of organizaing the overlay structure and routing messages <em>(3.1: Kademlia)</em>. In order for a node to join the network it must generate an identity.</p><p>Identities are the RMD160 hash of an Equihash proof where the node's public key is the proof input. Messages are signed with the corresponding private key. This is designed to provide some resilience against sybil and, in particular, eclipse attacks. An eclipse attack is a type of censorship by which an attacker is able to manipulate the network's routing tables such that the attacker is able to &quot;surround&quot; a target without their knowledge.</p><p>In every message exchanged on the network, each party will include a tuple structure which includes enough information to locate and authenticate each party.</p><pre class="prettyprint source"><code>[&quot;&lt;node_id>&quot;, { /* &lt;contact> */ }]
</code></pre><h4 id="2.1-contact-hash-map">2.1 Contact Hash Map</h4><p>The second entry in the identity tuple contains additional information specific to addressing the node on the network. This includes:</p><pre class="prettyprint source"><code>{
  &quot;hostname&quot;: &quot;xxxxxxxx.onion&quot;,
  &quot;port&quot;: 80,
  &quot;protocol&quot;: &quot;http:&quot;,
  &quot;pubkey&quot;: &quot;...&quot;,
  &quot;proof&quot;: &quot;...&quot;
}
</code></pre><p>Additional properties may be included based on individual use cases within the network, however the properties above are <strong>required</strong>.</p><h3 id="3-network-structure">3 Network Structure</h3><p>Kadence employs a <strong>structured</strong> network, meaning that nodes are organized and route messages based on a deterministic metric. The network uses a <a href="http://www.scs.stanford.edu/~dm/home/papers/kpos.pdf">Kademlia</a> distributed hash table as the basis for the network overlay. In addition to Kademlia, Kadence also employs other extensions to mitigate issues and attacks defined by the work on <a href="http://www.tm.uka.de/doc/SKademlia_2007.pdf">S/Kademlia</a>.</p><h4 id="3.1-kademlia">3.1 Kademlia</h4><p>Once an Kadence node has completed generating its identity, it bootstraps its routing table by following the Kademlia &quot;join&quot; procedure. This involves querying a single known &quot;seed&quot; node for contact information about other nodes that possess a Node ID that is close (XOR distance) to its own <em>(<code>4.4 FIND_NODE</code>)</em>. This is done iteratively, sending the same query to the <code>ALPHA</code> (3) results that are closest, until the further queries no longer yield results that are closer or the routing table is sufficiently bootstrapped.</p><h4 id="3.2-transport">3.2 Transport</h4><p>The Kadence network operates over HTTP and exclusively over <a href="https://torproject.org">Tor</a>.</p><p>Each Kadence node exposes a V3 hidden service to other nodes for receiving RPC messages <em>(4. Remote Procedure Calls)</em>. Requests sent to the RPC endpoint require a special HTTP header <code>x-kad-message-id</code> to be included that matches the <code>id</code> parameter in the associated RPC message <em>(4.1 Structure and Authentication)</em>.</p><h3 id="4-remote-procedure-calls">4 Remote Procedure Calls</h3><ul><li><strong>Method:</strong> <code>POST</code></li><li><strong>Path:</strong> <code>/</code></li><li><strong>Content Type:</strong> <code>application/json</code></li><li><strong>Headers:</strong> <code>x-kad-message-id</code></li></ul><h4 id="4.1-structure-and-authentication">4.1 Structure and Authentication</h4><p>Each remote procedure call sent and received between nodes is composed in the same structure. Messages are formatted as a <a href="http://www.jsonrpc.org/specification">JSON-RPC 2.0</a> <em>batch</em> payload containing 3 objects. These objects are positional, so ordering matters. The anatomy of a message takes the form of:</p><pre class="prettyprint source"><code>[{ /* rpc */ },{ /* notification */ },{ /* notification */ }]
</code></pre><p>At position 0 is the RPC request/response object, which must follow the JSON-RPC specification for such an object. It must contain the properties: <code>jsonrpc</code>, <code>id</code>, <code>method</code>, and <code>params</code> if it is a request. It must contain the properties: <code>jsonrpc</code>, <code>id</code>, and one of <code>result</code> or <code>error</code> if it is a response.</p><p>At positions 1 and 2 are a JSON-RPC notification object, meaning that it is not required to contain an <code>id</code> property since no response is required. These two notifications always assert methods <code>IDENTIFY</code> and <code>AUTHENTICATE</code> respectively. Together, these objects provide the recipient with information regarding the identity and addressing information of the sender as well as a cryptographic signature to authenticate the payload.</p><p>For <code>STORE</code> message, an additional <code>HASHCASH</code> message is included in the payload to prevent spam.</p><h5 id="example%3A-request">Example: Request</h5><pre class="prettyprint source"><code>[
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;id&quot;: &quot;&lt;uuid_version_4>&quot;,
    &quot;method&quot;: &quot;&lt;method_name>&quot;,
    &quot;params&quot;: [&quot;&lt;parameter_one>&quot;, &quot;&lt;parameter_two>&quot;]
  },
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;method&quot;: &quot;IDENTIFY&quot;,
    &quot;params&quot;: [
      &quot;&lt;proof_hash>&quot;, 
      {
        &quot;hostname&quot;: &quot;sender.onion&quot;,
        &quot;port&quot;: 80,
        &quot;protocol&quot;: &quot;http:&quot;,
        &quot;pubkey&quot;: &quot;...&quot;,
        &quot;proof&quot;: &quot;...&quot;
      }
    ]
  },
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;method&quot;: &quot;AUTHENTICATE&quot;,
    &quot;params&quot;: [
      &quot;&lt;payload_signature>&quot;,
      &quot;&lt;public_key>&quot;
    ]
  }
]
</code></pre><h5 id="example%3A-response">Example: Response</h5><pre class="prettyprint source"><code>[
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;id&quot;: &quot;&lt;uuid_version_4_from_request>&quot;,
    &quot;result&quot;: [&quot;&lt;result_one>&quot;, &quot;&lt;result_two>&quot;]
  },
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;method&quot;: &quot;IDENTIFY&quot;,
    &quot;params&quot;: [
      &quot;&lt;proof_hash>&quot;, 
      {
        &quot;hostname&quot;: &quot;receiver.onion&quot;,
        &quot;port&quot;: 80,
        &quot;protocol&quot;: &quot;http:&quot;,
        &quot;pubkey&quot;: &quot;...&quot;,
        &quot;proof&quot;: &quot;...&quot;
      }
    ]
  },
  {
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;method&quot;: &quot;AUTHENTICATE&quot;,
    &quot;params&quot;: [
      &quot;&lt;payload_signature>&quot;,
      &quot;&lt;public_key>&quot;
    ]
  }
]
</code></pre><p>In the examples above, <code>proof_hash</code> and <code>public_key</code> must be encoded as hexidecimal string and <code>payload_signature</code> must be encoded as a base64 string which is the concatenation of the public key recovery number with the actual signature of the payload - excluding the object at index 2 (<code>AUTHENTICATE</code>). This means that the message to be signed is <code>[rpc, identify]</code>.</p><blockquote><p>Note the exclusion of a timestamp or incrementing nonce in the payload means that a man-in-the-middle could carry out a replay attack. To combat this, it is urged that the <code>id</code> parameter of the RPC message (which is a universally unique identifier) be stored for a reasonable period of time and nodes should reject messages that attempt to use a duplicate UUID.</p></blockquote><p>The rest of this section describes each individual method in the base protocol and defines the parameter and result signatures that are expected. If any RPC message yields an error, then an <code>error</code> property including <code>code</code> and <code>message</code> should be send in place of the <code>result</code> property.</p><h4 id="4.2-ping">4.2 <code>PING</code></h4><p>This RPC involves one node sending a <code>PING</code> message to another, which presumably replies. This has a two-fold effect: the recipient of the <code>PING</code> must update the bucket corresponding to the sender; and, if there is a reply, the sender must update the bucket appropriate to the recipient.</p><p>Parameters: <code>[]</code><br>Results: <code>[]</code></p><h4 id="4.3-find_node">4.3 <code>FIND_NODE</code></h4><p>Basic kademlia lookup operation that builds a set of K contacts closest to the the given key. The <code>FIND_NODE</code> RPC includes a 160-bit key. The recipient of the RPC returns up to K contacts that it knows to be closest to the key. The recipient must return K contacts if at all possible. It may only return fewer than K if it is returning all of the contacts that it has knowledge of.</p><p>Parameters: <code>[key_160_hex]</code><br>Results: <code>[contact_0, contact_1, ...contactN]</code></p><h4 id="4.4-find_value">4.4 <code>FIND_VALUE</code></h4><p>Kademlia search operation that is conducted as a node lookup and builds a list of K closest contacts. If at any time during the lookup the value is returned, the search is abandoned. If no value is found, the K closest contacts are returned. Upon success, we must store the value at the nearest node seen during the search that did not return the value.</p><p>A <code>FIND_VALUE</code> RPC includes a B=160-bit key. If a corresponding value is present on the recipient, the associated data is returned. Otherwise the RPC is equivalent to a <code>FIND_NODE</code> and a set of K contacts is returned.</p><p>If a value is returned, it must be in the form of an object with properties: <code>timestamp</code> as a UNIX timestamp in milliseconds, <code>publisher</code> as a 160 bit public key hash in hexidecimal of the original publisher, and <code>value</code> which may be of mixed type that is valid JSON.</p><p>Parameters: <code>[key_160_hex]</code><br>Results: <code>{ timestamp, publisher, value }</code> or <code>[...contactN]</code></p><h4 id="4.5-store">4.5 <code>STORE</code></h4><p>The sender of the <code>STORE</code> RPC provides a key and a block of data and requires that the recipient store the data and make it available for later retrieval by that key. Kadence <strong>requires</strong> that the key is the RMD160 hash of the supplied blob and that the blob is <em>exactly</em> equal to 2MiB in size and encoded as base64.</p><p>Parameters: <code>[key_160_hex, 2mib_value_base64]</code><br>Results: <code>[key_160_hex, 2mib_value_base64]</code></p><p>An additional <code>HASHCASH</code> payload is appended to this message.</p><pre class="prettyprint source"><code>{
  &quot;jsonrpc&quot;: &quot;2.0&quot;,
  &quot;method&quot;: &quot;HASHCASH&quot;,
  &quot;params&quot;: [&quot;&lt;hashcash_stamp>&quot;]
}
</code></pre><p>The stamp follows the hashcash specification. The resource segment of the stamp is the sender identity, target identity, and method name concatenated. The difficulty may be adjusted by community consensus to account for potential attacks.</p><h3 id="9-references">9 References</h3><ul><li>Kademlia (<code>http://www.scs.stanford.edu/~dm/home/papers/kpos.pdf</code>)</li><li>S/Kademlia (<code>http://www.tm.uka.de/doc/SKademlia_2007.pdf</code>)</li></ul></article></section></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><div class="mobile-nav-links"></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-modules"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-kadence_churnfilter.html">kadence/churnfilter</a></div><div class="sidebar-section-children"><a href="module-kadence_constants.html">kadence/constants</a></div><div class="sidebar-section-children"><a href="module-kadence_contentaddress.html">kadence/contentaddress</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse.html">kadence/eclipse</a></div><div class="sidebar-section-children"><a href="module-kadence_hashcash.html">kadence/hashcash</a></div><div class="sidebar-section-children"><a href="module-kadence_hibernate.html">kadence/hibernate</a></div><div class="sidebar-section-children"><a href="module-kadence_logger.html">kadence/logger</a></div><div class="sidebar-section-children"><a href="module-kadence_onion.html">kadence/onion</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar.html">kadence/quasar</a></div><div class="sidebar-section-children"><a href="module-kadence_rolodex.html">kadence/rolodex</a></div><div class="sidebar-section-children"><a href="module-kadence_spartacus.html">kadence/spartacus</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse.html">kadence/traverse</a></div><div class="sidebar-section-children"><a href="module-kadence_trust.html">kadence/trust</a></div><div class="sidebar-section-children"><a href="module-kadence_utils.html">kadence/utils</a></div><div class="sidebar-section-children"><a href="module-kadence_version.html">kadence/version</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AbstractNode.html">AbstractNode</a></div><div class="sidebar-section-children"><a href="Bucket.html">Bucket</a></div><div class="sidebar-section-children"><a href="ContactList.html">ContactList</a></div><div class="sidebar-section-children"><a href="Control.html">Control</a></div><div class="sidebar-section-children"><a href="ErrorRules.html">ErrorRules</a></div><div class="sidebar-section-children"><a href="HTTPSTransport.html">HTTPSTransport</a></div><div class="sidebar-section-children"><a href="HTTPTransport.html">HTTPTransport</a></div><div class="sidebar-section-children"><a href="KademliaNode.html">KademliaNode</a></div><div class="sidebar-section-children"><a href="KademliaRules.html">KademliaRules</a></div><div class="sidebar-section-children"><a href="Messenger.html">Messenger</a></div><div class="sidebar-section-children"><a href="module-kadence_churnfilter-ChurnFilterPlugin.html">ChurnFilterPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_contentaddress-ContentAddressPlugin.html">ContentAddressPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipseIdentity.html">EclipseIdentity</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipsePlugin.html">EclipsePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_eclipse-EclipseRules.html">EclipseRules</a></div><div class="sidebar-section-children"><a href="module-kadence_hashcash-HashCashPlugin.html">HashCashPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_hibernate-HibernatePlugin.html">HibernatePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_logger-IncomingMessageLogger.html">IncomingMessageLogger</a></div><div class="sidebar-section-children"><a href="module-kadence_logger-OutgoingMessageLogger.html">OutgoingMessageLogger</a></div><div class="sidebar-section-children"><a href="module-kadence_onion-OnionPlugin.html">OnionPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar-QuasarPlugin.html">QuasarPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_quasar-QuasarRules.html">QuasarRules</a></div><div class="sidebar-section-children"><a href="module-kadence_rolodex-RolodexPlugin.html">RolodexPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_spartacus-SpartacusPlugin.html">SpartacusPlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-NATPMPStrategy.html">NATPMPStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-ReverseTunnelStrategy.html">ReverseTunnelStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-TraversePlugin.html">TraversePlugin</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-TraverseStrategy.html">TraverseStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_traverse-UPNPStrategy.html">UPNPStrategy</a></div><div class="sidebar-section-children"><a href="module-kadence_trust-TrustPlugin.html">TrustPlugin</a></div><div class="sidebar-section-children"><a href="RoutingTable.html">RoutingTable</a></div><div class="sidebar-section-children"><a href="UDPTransport.html">UDPTransport</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-events"><div>Events</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AbstractNode.html#event:error">error</a></div><div class="sidebar-section-children"><a href="AbstractNode.html#event:join">join</a></div><div class="sidebar-section-children"><a href="KademliaNode.html#event:error">error</a></div><div class="sidebar-section-children"><a href="KademliaNode.html#event:join">join</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-config.html">Configuration Guide</a></div><div class="sidebar-section-children"><a href="tutorial-identities.html">Contacts and Identities</a></div><div class="sidebar-section-children"><a href="tutorial-install.html">Installing Kadence</a></div><div class="sidebar-section-children"><a href="tutorial-messengers.html">Message Format</a></div><div class="sidebar-section-children"><a href="tutorial-middleware.html">Middleware Stack</a></div><div class="sidebar-section-children"><a href="tutorial-nat.html">Traversing NATs and Firewalls</a></div><div class="sidebar-section-children"><a href="tutorial-plugins.html">Using and Authoring Plugins</a></div><div class="sidebar-section-children"><a href="tutorial-protocol.html">Protocol Specification</a></div><div class="sidebar-section-children"><a href="tutorial-quickstart.html">Getting Started</a></div><div class="sidebar-section-children"><a href="tutorial-transport-adapters.html">Transport Adapters</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>